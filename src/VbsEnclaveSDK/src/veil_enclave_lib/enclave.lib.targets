<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    
   <!-- Copy pragma linker statements from the Export.cpp file generated by edlcodegen.exe into veil_abi_exports.cpp -->
  <Target Name="GenerateExportPragmaLinkerStatements" AfterTargets="VbsEnclaveCodeGeneration">
    <PropertyGroup>
      <GeneratedExportsCppFile>$(ProjectDir)Generated Files\VbsEnclave\Enclave\Abi\Exports.cpp</GeneratedExportsCppFile>
      <VeilAbiExportsFile>$(ProjectDir)Generated Files\Veil\Enclave\veil_abi_exports.cpp</VeilAbiExportsFile>
    </PropertyGroup>

      <WriteLinesToFile
        Condition="!Exists('$(VeilAbiExportsFile)')"
        File="$(VeilAbiExportsFile)"
        Lines=""
        Overwrite="true" />
      
      <Exec Command="powershell -ExecutionPolicy Bypass -File &quot;$(ProjectDir)GenerateVeilExportStatements.ps1&quot; -InputFile &quot;$(GeneratedExportsCppFile)&quot; -OutputFile &quot;$(VeilAbiExportsFile)&quot;" />
  </Target>

</Project>
